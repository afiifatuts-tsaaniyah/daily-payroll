<?php

namespace App\Models\Master;

/*********************************************************************
 *  Created By       :  Generator Version 1.0.23                     *
 *  Created Date     :  Feb 13, 2022                                 *
 *  Description      : All code generated by model generator         *
 *  Generator Author : Tommy Maurice(tommy_maurice@yahoo.com)        *
 *********************************************************************/

use CodeIgniter\Model;

class M_mt_salary extends Model
{
     /* START PRIVATE VARIABLES */
     protected $DBGroup = '';
     protected $table = 'mt_salary';
     protected $primaryKey = 'salary_id';
     protected $returnType = 'array';
     protected $db = null;

     protected $salaryId;
     protected $biodataId;
     protected $accNo;
     protected $accName;
     protected $clientName;
     protected $bankId;
     protected $monthly;
     protected $daily;
     protected $isActive;
     protected $bpjs;
     protected $jht;
     protected $jp;
     protected $jkkjkm;
     protected $month;
     protected $picInput;
     protected $inputTime;
     protected $picEdit;
     protected $editTime;
     /* END PRIVATE VARIABLES */
     /* START CONSTRUCTOR */
     public function __construct()
     {
          parent::__construct();
          $this->db = \Config\Database::connect($this->DBGroup, false);
          $this->salaryId = '';
          $this->biodataId = '';
          $this->bankId = '';
          $this->accNo = '';
          $this->accName = '';
          $this->monthly = 0;
          $this->daily = 0;
          $this->isActive = 0;
          $this->bpjs = 0;
          $this->jht = 0;
          $this->jp = 0;
          $this->jkkjkm = 0;
          $this->month = '';
          $this->clientName = '';
          $this->picInput = '';
          $this->inputTime = '1700-01-01 00:00:00';
          $this->picEdit = '';
          $this->editTime = '1700-01-01 00:00:00';
     }
     /* END CONSTRUCTOR */

     /* START GENERATE SETTER AND GETTER */
     public function setSalaryId($aSalaryId)
     {
          $this->salaryId = $aSalaryId;
     }
     public function getSalaryId()
     {
          return $this->salaryId;
     }
     public function setBiodataId($aBiodataId)
     {
          $this->biodataId = $aBiodataId;
     }
     public function getBiodataId()
     {
          return $this->biodataId;
     }
     public function setaccNo($aaccNo)
     {
          $this->accNo = $aaccNo;
     }
     public function getaccNo()
     {
          return $this->accNo;
     }
     public function setaccName($aaccName)
     {
          $this->accName = $aaccName;
     }
     public function getaccName()
     {
          return $this->accName;
     }
     public function setBankId($aBankId)
     {
          $this->bankId = $aBankId;
     }
     public function getBankId()
     {
          return $this->bankId;
     }
     public function setMonthly($aMonthly)
     {
          $this->monthly = $aMonthly;
     }
     public function getMonthly()
     {
          return $this->monthly;
     }
     public function setDaily($aDaily)
     {
          $this->daily = $aDaily;
     }
     public function getDaily()
     {
          return $this->daily;
     }
     public function setIsActive($aIsActive)
     {
          $this->isActive = $aIsActive;
     }
     public function getIsActive()
     {
          return $this->isActive;
     }
     public function setbpjs($abpjs)
     {
          $this->bpjs = $abpjs;
     }
     public function getbpjs()
     {
          return $this->bpjs;
     }
     public function setjht($ajht)
     {
          $this->jht = $ajht;
     }
     public function getjht()
     {
          return $this->jht;
     }
     public function setjp($ajp)
     {
          $this->jp = $ajp;
     }
     public function getjp()
     {
          return $this->jp;
     }
     public function setjkkjkm($ajkkjkm)
     {
          $this->jkkjkm = $ajkkjkm;
     }
     public function getjkkjkm()
     {
          return $this->jkkjkm;
     }
     public function setmonth($amonth)
     {
          $this->month = $amonth;
     }
     public function getmonth()
     {
          return $this->month;
     }
     public function setClientName($aClientName)
     {
          $this->clientName = $aClientName;
     }
     public function getClientName()
     {
          return $this->clientName;
     }
     public function setPicInput($aPicInput)
     {
          $this->picInput = $aPicInput;
     }
     public function getPicInput()
     {
          return $this->picInput;
     }
     public function setInputTime($aInputTime)
     {
          $this->inputTime = $aInputTime;
     }
     public function getInputTime()
     {
          return $this->inputTime;
     }
     public function setPicEdit($aPicEdit)
     {
          $this->picEdit = $aPicEdit;
     }
     public function getPicEdit()
     {
          return $this->picEdit;
     }
     public function setEditTime($aEditTime)
     {
          $this->editTime = $aEditTime;
     }
     public function getEditTime()
     {
          return $this->editTime;
     }
     /* END GENERATE SETTER AND GETTER */
     /* START INSERT */
     public function ins()
     {
          if ($this->salaryId == "" || $this->salaryId == NULL) {
               $this->salaryId = '';
          }
          if ($this->biodataId == "" || $this->biodataId == NULL) {
               $this->biodataId = '';
          }
          if ($this->accNo == "" || $this->accNo == NULL) {
               $this->accNo = '';
          }
          if ($this->accName == "" || $this->accName == NULL) {
               $this->accName = '';
          }
          if ($this->bankId == "" || $this->bankId == NULL) {
               $this->bankId = '';
          }
          if ($this->monthly == "" || $this->monthly == NULL) {
               $this->monthly = 0;
          }
          if ($this->daily == "" || $this->daily == NULL) {
               $this->daily = 0;
          }
          if ($this->bpjs == "" || $this->bpjs == NULL) {
               $this->bpjs = 0;
          }
          if ($this->jht == "" || $this->jht == NULL) {
               $this->jht = 0;
          }
          if ($this->jp == "" || $this->jp == NULL) {
               $this->jp = 0;
          }
          if ($this->jkkjkm == "" || $this->jkkjkm == NULL) {
               $this->jkkjkm = 0;
          }
          if ($this->month == "" || $this->month == NULL) {
               $this->month = '';
          }
          if ($this->isActive == "" || $this->isActive == NULL) {
               $this->isActive = 0;
          }
          if ($this->picInput == "" || $this->picInput == NULL) {
               $this->picInput = '';
          }
          if ($this->clientName == "" || $this->clientName == NULL) {
               $this->clientName = '';
          }
          if ($this->inputTime == "" || $this->inputTime == NULL) {
               $this->inputTime = '1700-01-01 00:00:00';
          }
          if ($this->picEdit == "" || $this->picEdit == NULL) {
               $this->picEdit = '';
          }
          if ($this->editTime == "" || $this->editTime == NULL) {
               $this->editTime = '1700-01-01 00:00:00';
          }

          $stQuery  = "INSERT INTO " . $this->table . " ";
          $stQuery .= "( ";
          $stQuery .=   "salary_id,";
          $stQuery .=   "biodata_id,";
          $stQuery .=   "bank_id,";
          $stQuery .=   "account_no,";
          $stQuery .=   "account_name,";
          $stQuery .=   "monthly,";
          $stQuery .=   "daily,";
          $stQuery .=   "bpjs_check,";
          $stQuery .=   "jht_check,";
          $stQuery .=   "jp_check,";
          $stQuery .=   "jkm_check,";
          $stQuery .=   "status_payroll,";
          $stQuery .=   "company_name,";
          $stQuery .=   "is_active,";
          $stQuery .=   "pic_input,";
          $stQuery .=   "input_time,";
          $stQuery .=   "pic_edit,";
          $stQuery .=   "edit_time";
          $stQuery .= ") ";
          $stQuery .= "VALUES ";
          $stQuery .= "( ";
          $stQuery .=   "'" . $this->salaryId . "',";
          $stQuery .=   "'" . $this->biodataId . "',";
          $stQuery .=   "'" . $this->bankId . "',";
          $stQuery .=   "'" . $this->accNo . "',";
          $stQuery .=   "'" . $this->accName . "',";
          $stQuery .=   " " . $this->monthly . ",";
          $stQuery .=   " " . $this->daily . ",";
          $stQuery .=   " '" . $this->bpjs . "',";
          $stQuery .=   " '" . $this->jht . "',";
          $stQuery .=   " '" . $this->jp . "',";
          $stQuery .=   " '" . $this->jkkjkm . "',";
          $stQuery .=   " '" . $this->month . "',";
          $stQuery .=   " '" . $this->clientName . "',";
          $stQuery .=   " '" . $this->isActive . "',";
          $stQuery .=   "'" . $this->picInput . "',";
          $stQuery .=   "'" . $this->inputTime . "',";
          $stQuery .=   "'" . $this->picEdit . "',";
          $stQuery .=   "'" . $this->editTime . "'";
          $stQuery .= "); ";
          $this->db->query($stQuery);
     }
     /* END INSERT */
     /* START QUERY INSERT */
     public function getInsQuery()
     {
          if ($this->salaryId == "" || $this->salaryId == NULL) {
               $this->salaryId = '';
          }
          if ($this->biodataId == "" || $this->biodataId == NULL) {
               $this->biodataId = '';
          }
          if ($this->accNo == "" || $this->accNo == NULL) {
               $this->accNo = '';
          }
          if ($this->accName == "" || $this->accName == NULL) {
               $this->accName = '';
          }
          if ($this->bankId == "" || $this->bankId == NULL) {
               $this->bankId = '';
          }
          if ($this->monthly == "" || $this->monthly == NULL) {
               $this->monthly = 0;
          }
          if ($this->daily == "" || $this->daily == NULL) {
               $this->daily = 0;
          }
          if ($this->bpjs == "" || $this->bpjs == NULL) {
               $this->bpjs = 0;
          }
          if ($this->jht == "" || $this->jht == NULL) {
               $this->jht = 0;
          }
          if ($this->jp == "" || $this->jp == NULL) {
               $this->jp = 0;
          }
          if ($this->jkkjkm == "" || $this->jkkjkm == NULL) {
               $this->jkkjkm = 0;
          }
          if ($this->isActive == "" || $this->isActive == NULL) {
               $this->isActive = 0;
          }
          if ($this->picInput == "" || $this->picInput == NULL) {
               $this->picInput = '';
          }
          if ($this->inputTime == "" || $this->inputTime == NULL) {
               $this->inputTime = '1700-01-01 00:00:00';
          }
          if ($this->picEdit == "" || $this->picEdit == NULL) {
               $this->picEdit = '';
          }
          if ($this->editTime == "" || $this->editTime == NULL) {
               $this->editTime = '1700-01-01 00:00:00';
          }

          $stQuery  = "INSERT INTO " . $this->table . " ";
          $stQuery .= "( ";
          $stQuery .=   "salary_id,";
          $stQuery .=   "biodata_id,";
          $stQuery .=   "account_no,";
          $stQuery .=   "account_name,";
          $stQuery .=   "bank_id,";
          $stQuery .=   "monthly,";
          $stQuery .=   "daily,";
          $stQuery .=   "is_active,";
          $stQuery .=   "pic_input,";
          $stQuery .=   "input_time,";
          $stQuery .=   "pic_edit,";
          $stQuery .=   "edit_time";
          $stQuery .= ") ";
          $stQuery .= "VALUES ";
          $stQuery .= "( ";
          $stQuery .=   "'" . $this->salaryId . "',";
          $stQuery .=   "'" . $this->biodataId . "',";
          $stQuery .=   "'" . $this->accNo . "',";
          $stQuery .=   "'" . $this->accName . "',";
          $stQuery .=   "'" . $this->bankId . "',";
          $stQuery .=   " " . $this->monthly . ",";
          $stQuery .=   " " . $this->daily . ",";
          $stQuery .=   " " . $this->isActive . ",";
          $stQuery .=   "'" . $this->picInput . "',";
          $stQuery .=   "'" . $this->inputTime . "',";
          $stQuery .=   "'" . $this->picEdit . "',";
          $stQuery .=   "'" . $this->editTime . "'";
          $stQuery .= "); ";
          $this->db->query($stQuery);
     }
     /* END QUERY INSERT */
     /* START UPDATE */
     public function upd($id)
     {
          if ($this->salaryId == "" || $this->salaryId == NULL) {
               $this->salaryId = '';
          }
          if ($this->biodataId == "" || $this->biodataId == NULL) {
               $this->biodataId = '';
          }
          if ($this->accNo == "" || $this->accNo == NULL) {
               $this->accNo = '';
          }
          if ($this->accName == "" || $this->accName == NULL) {
               $this->accName = '';
          }
          if ($this->bankId == "" || $this->bankId == NULL) {
               $this->bankId = '';
          }
          if ($this->monthly == "" || $this->monthly == NULL) {
               $this->monthly = 0;
          }
          if ($this->daily == "" || $this->daily == NULL) {
               $this->daily = 0;
          }
          if ($this->isActive == "" || $this->isActive == NULL) {
               $this->isActive = 0;
          }
          if ($this->month == "" || $this->month == NULL) {
               $this->month = '';
          }
          if ($this->bpjs == "" || $this->bpjs == NULL) {
               $this->bpjs = 0;
          }
          if ($this->jht == "" || $this->jht == NULL) {
               $this->jht = 0;
          }
          if ($this->jp == "" || $this->jp == NULL) {
               $this->jp = 0;
          }
          if ($this->jkkjkm == "" || $this->jkkjkm == NULL) {
               $this->jkkjkm = 0;
          }
          if ($this->picInput == "" || $this->picInput == NULL) {
               $this->picInput = '';
          }
          if ($this->inputTime == "" || $this->inputTime == NULL) {
               $this->inputTime = '1700-01-01 00:00:00';
          }
          if ($this->picEdit == "" || $this->picEdit == NULL) {
               $this->picEdit = '';
          }
          if ($this->editTime == "" || $this->editTime == NULL) {
               $this->editTime = '1700-01-01 00:00:00';
          }

          $stQuery  = "UPDATE " . $this->table . " ";
          $stQuery .= "SET ";
          // $stQuery .=   "salary_id ='".$this->db->escapeString($this->salaryId)."', "; 
          $stQuery .=   "biodata_id ='" . $this->biodataId . "', ";
          $stQuery .=   "account_no ='" . $this->accNo . "', ";
          $stQuery .=   "account_name ='" . $this->accName . "', ";
          $stQuery .=   "bank_id ='" . $this->bankId . "', ";
          // $stQuery .=   'account_no ='.$this->accNo.','; 
          $stQuery .=   'monthly =' . $this->monthly . ',';
          $stQuery .=   'daily =' . $this->daily . ',';
          $stQuery .=   'bpjs_check =' . $this->bpjs . ',';
          $stQuery .=   'jht_check =' . $this->jht . ',';
          $stQuery .=   'jp_check =' . $this->jp . ',';
          $stQuery .=   'jkm_check =' . $this->jkkjkm . ',';
          $stQuery .=   'status_payroll ="' . $this->month . '",';
          $stQuery .=   'company_name ="' . $this->clientName . '",';
          // $stQuery .=   'is_active ='.$this->isActive.','; 
          // $stQuery .=   "pic_input ='".$this->picInpu)."', "; 
          // $stQuery .=   "input_time ='".$this->inputTim)."', "; 
          $stQuery .=   "pic_edit ='" . $this->picEdit . "', ";
          $stQuery .=   "edit_time ='" . $this->editTime . "' ";
          $stQuery .= 'WHERE ';
          $stQuery .=   "salary_id = '" . $id . "'";
          // echo $stQuery;
          // exit();
          $this->db->query($stQuery);
     }
     /* END UPDATE */
     /* START QUERY UPDATE */
     public function getUpdQuery($id)
     {
          if ($this->salaryId == "" || $this->salaryId == NULL) {
               $this->salaryId = '';
          }
          if ($this->biodataId == "" || $this->biodataId == NULL) {
               $this->biodataId = '';
          }
          if ($this->accNo == "" || $this->accNo == NULL) {
               $this->accNo = '';
          }
          if ($this->accName == "" || $this->accName == NULL) {
               $this->accName = '';
          }
          if ($this->bankId == "" || $this->bankId == NULL) {
               $this->bankId = '';
          }
          if ($this->monthly == "" || $this->monthly == NULL) {
               $this->monthly = 0;
          }
          if ($this->daily == "" || $this->daily == NULL) {
               $this->daily = 0;
          }
          if ($this->isActive == "" || $this->isActive == NULL) {
               $this->isActive = 0;
          }
          if ($this->picInput == "" || $this->picInput == NULL) {
               $this->picInput = '';
          }
          if ($this->inputTime == "" || $this->inputTime == NULL) {
               $this->inputTime = '1700-01-01 00:00:00';
          }
          if ($this->picEdit == "" || $this->picEdit == NULL) {
               $this->picEdit = '';
          }
          if ($this->editTime == "" || $this->editTime == NULL) {
               $this->editTime = '1700-01-01 00:00:00';
          }

          $stQuery  = "UPDATE " . $this->table . " ";
          $stQuery .= "SET ";
          $stQuery .=   "salary_id ='" . $this->salaryId . "', ";
          $stQuery .=   "biodata_id ='" . $this->biodataId . "', ";
          $stQuery .=   "account_no ='" . $this->accNo . "', ";
          $stQuery .=   "account_name ='" . $this->accName . "', ";
          $stQuery .=   "bank_id ='" . $this->bankId . "', ";
          $stQuery .=   'monthly =' . $this->monthly . ',';
          $stQuery .=   'daily =' . $this->daily . ',';
          $stQuery .=   'is_active =' . $this->isActive . ',';
          $stQuery .=   "pic_input ='" . $this->picInput . "', ";
          $stQuery .=   "input_time ='" . $this->inputTime . "', ";
          $stQuery .=   "pic_edit ='" . $this->picEdit . "', ";
          $stQuery .=   "edit_time ='" . $this->editTime . "' ";
          $stQuery .= 'WHERE ';
          $stQuery .=   "salary_id = '" . $id . "'";
          return $stQuery;
     }
     /* END QUERY UPDATE */
     /* START DELETE */

     public function del($id)
     {
          $stQuery  = "UPDATE " . $this->table . " ";
          $stQuery .= "SET ";
          $stQuery .=   "is_active ='0'";
          $stQuery .= 'WHERE ';
          $stQuery .=   "salary_id = '" . $id . "'";
          $this->db->query($stQuery);
     }

     public function nonActive($id)
     {
          $stQuery  = "UPDATE " . $this->table . " ";
          $stQuery .= "SET ";
          $stQuery .=   "is_active ='0'";
          $stQuery .= 'WHERE ';
          $stQuery .=   "salary_id = '" . $id . "'";
          $this->db->query($stQuery);
     }

     public function active($id)
     {
          $stQuery  = "UPDATE " . $this->table . " ";
          $stQuery .= "SET ";
          $stQuery .=   "is_active ='1'";
          $stQuery .= 'WHERE ';
          $stQuery .=   "salary_id = '" . $id . "'";
          $this->db->query($stQuery);
     }
     /* END DELETE */
     /* START GET ALL DATA */
     public function getAll()
     {
          $stQuery  = "SELECT a.*,b.full_name,c.bank_name FROM mt_salary a, mt_biodata_01 b, mt_bank c  WHERE a.biodata_id = b.biodata_id AND a.bank_id = c.bank_id AND a.is_active='1' ";
          $query  = $this->db->query($stQuery);
          $arrayList = $query->getResultArray();
          return $arrayList;
     }

     public function getAllbio()
     {
          $stQuery = "SELECT a.* FROM mt_biodata_01 a LEFT JOIN mt_salary b ON a.biodata_id = b.biodata_id WHERE  b.biodata_id IS NULL  AND a.is_active = '1'";
          // echo $stQuery;
          // exit();
          $query  = $this->db->query($stQuery);
          return $query->getResult();
     }
     /* END GET ALL DATA */
     /* START GET DATA BY ID */
     public function getById($id)
     {
          $stQuery  = "SELECT a.*,a.status_payroll AS status,b.full_name,c.bank_name FROM mt_salary a, mt_biodata_01 b, mt_bank c ";
          $stQuery .= "WHERE a.biodata_id = b.biodata_id AND a.bank_id = c.bank_id AND salary_id = '" . ($id) . "'";
          $query  = $this->db->query($stQuery);
          $arrayRow = $query->getRowArray();
          return $arrayRow;
     }

     public function getByBioId($id)
     {
          $stQuery  = "SELECT a.*,b.full_name,c.bank_name FROM mt_salary a, mt_biodata_01 b, mt_bank c ";
          $stQuery .= "WHERE a.biodata_id = b.biodata_id AND a.bank_id = c.bank_id AND a.biodata_id = '" . $id . "'";
          // echo $stQuery;
          //  exit();
          $query  = $this->db->query($stQuery);
          $arrayRow = $query->getRowArray();
          return $arrayRow;
     }
     /* END GET DATA BY ID */
     /* START GET OBJECT DATA BY ID */
     public function setObjectById($id)
     {
          $stQuery  = "SELECT * FROM " . $this->table . " ";
          $stQuery .= "WHERE salary_id = '" . ($id) . "'";
          $query  = $this->db->query($stQuery);
          $arrayRow = $query->getRowArray();
          $this->salaryId = $arrayRow['salary_id'];
          $this->biodataId = $arrayRow['biodata_id'];
          $this->bankId = $arrayRow['bank_id'];
          $this->monthly = $arrayRow['monthly'];
          $this->clientName = $arrayRow['company_name'];
          $this->daily = $arrayRow['daily'];
          $this->isActive = $arrayRow['is_active'];
          $this->picInput = $arrayRow['pic_input'];
          $this->inputTime = $arrayRow['input_time'];
          $this->picEdit = $arrayRow['pic_edit'];
          $this->editTime = $arrayRow['edit_time'];
     }
     /* END GET OBJECT DATA BY ID */
     /* START OF RESET VALUES */
     public function resetValues()
     {
          $this->salaryId = '';
          $this->biodataId = '';
          $this->idNo = '';
          $this->dept = '';
          $this->bankId = '';
          $this->monthly = 0;
          $this->daily = 0;
          $this->isActive = 0;
          $this->picInput = '';
          $this->clientName = '';
          $this->inputTime = '1700-01-01 00:00:00';
          $this->picEdit = '';
          $this->editTime = '1700-01-01 00:00:00';
     }
     /* END OF RESET VALUES */
     /* START OF ID GENERATOR */
     public function generateId($columnId)
     {
          $strSql = "SELECT ";
          $strSql .= " CASE WHEN id_year = curr_ym THEN ";
          $strSql .= "   CONCAT(id_year,LPAD(CAST( (CAST(RIGHT(fi,5) AS INTEGER)+1) AS CHAR),5,'0')) ";
          $strSql .= " ELSE ";
          $strSql .= "   CONCAT(curr_ym, '00001') ";
          $strSql .= " END AS doc_id ";
          $strSql .= "FROM ";
          $strSql .= " (SELECT ";
          $strSql .= "   MAX(" . $columnId . ") fi,";
          $strSql .= "   LEFT(" . $columnId . ",4) id_year,";
          $strSql .= "   current_date dt,";
          $strSql .= "   RIGHT(" . $columnId . ", 5) curr_id,";
          $strSql .= "   CONCAT(";
          $strSql .= "   RIGHT(CAST(DATE_FORMAT(NOW(), '%y') AS CHAR),2), ";
          $strSql .= "   LPAD(";
          $strSql .= "      CAST(DATE_FORMAT(NOW(), '%m') AS CHAR),2,'0'";
          $strSql .= "    )";
          $strSql .= "   ) curr_ym,";
          $strSql .= "   RIGHT(CAST(DATE_FORMAT(NOW(), '%y') AS CHAR),2) tYear,";
          $strSql .= "   CAST(DATE_FORMAT(NOW(), '%m') AS CHAR) tMonth ";
          $strSql .= " FROM ";
          $strSql .= "   " . $this->table . " ";
          $strSql .= " GROUP BY " . $columnId . ") a ";
          $strSql .= " ORDER BY doc_id DESC LIMIT 1 ";
          $query  = $this->db->query($strSql);
          $arrayRow = $query->getRowArray();
          if (!isset($arrayRow)) {
               $curYM = date('ym');
               $arrayRow['doc_id'] = $curYM . '00001';
          }
          return $arrayRow;
     }
     /* END OF ID GENERATOR */
     function get_salary_Active()
     {
          $stQuery = "SELECT salary_id, id_no FROM " . $this->table . " ";
          $stQuery .= "WHERE is_Active = '1' ";
          $query   = $this->db->query($stQuery);
          return $query->getResult();
     }

     function get_salary_foreign()
     {
          $stQuery = "SELECT salary_id, id_no FROM " . $this->table . " ";
          $stQuery .= "WHERE is_Active = '0' ";
          $query   = $this->db->query($stQuery);
          return $query->getResult();
     }

     public function loadSalaryIdByBiodataId($biodataId)
     {
          return $this->where('biodata_id', $biodataId)
               ->first(); // ambil satu baris pertama
     }
}
