<?php namespace App\Models\Report; 
/*********************************************************************
 *  Created By       :  Generator Version 1.0.23                     *
 *  Created Date     :  Aug 18, 2020                                 *
 *  Description      : All code generated by model generator         *
 *  Generator Author : Tommy Maurice(tommy_maurice@yahoo.com)        *
 *********************************************************************/
use CodeIgniter\Model;

class M_mtb_thr extends Model
{
     /* START PRIVATE VARIABLES */
     protected $DBGroup = 'hris';
     protected $table = 'tr_slip';
     protected $primaryKey = 'slip_id';
     protected $returnType = 'array';
     protected $db = null;

    public function getDataEmpByDept($startYears, $endYears, $dept)
    {
          $stQuery = "SELECT DISTINCT a.biodata_id, b.monthly, b.daily, b.account_no, b.status_payroll, c.full_name FROM rp_db a, mt_salary b, mt_biodata_01 c WHERE a.biodata_id = b.biodata_id AND a.biodata_id = c.biodata_id AND a.date_process BETWEEN '".$startYears."' AND '".$endYears."' AND a.dept = '".$dept."' ";
          // echo $stQuery;
          // exit();
          $query   = $this->db->query($stQuery);
          return $query->getResultArray();
    }

    public function getWorkDayMonth($startYears, $endYears, $dept, $biodataId)
    {
         $stQuery = "SELECT SUM(work_day) AS WD FROM rp_db WHERE date_process BETWEEN '".$startYears."' AND '".$endYears."' AND dept = '".$dept."' AND biodata_id = '".$biodataId."'";
          // echo $stQuery;
          // exit();
          $query   = $this->db->query($stQuery);
          return $query->getRowArray();
    }

     public function getAllDept($startYears, $endYears)
     {
          $stQuery = "SELECT DISTINCT dept FROM rp_db WHERE date_process BETWEEN '".$startYears."' AND '".$endYears."' ";
          $query   = $this->db->query($stQuery);
          return $query->getResultArray();
     }

     public function getAllEmpByDept($startYears, $endYears, $dept)
     {
          $stQuery = "SELECT DISTINCT a.biodata_id, b.monthly FROM rp_db a, mt_salary b WHERE a.biodata_id = b.biodata_id AND a.date_process BETWEEN '".$startYears."' AND '".$endYears."' AND dept = '".$dept."' ";
          // echo $stQuery;
          // exit();
          $query   = $this->db->query($stQuery);
          return $query->getResultArray();
     }

     public function getTotalWorkDay($startYears, $endYears, $dept)
     {
           $stQuery = "SELECT SUM(work_day) AS WD FROM rp_db WHERE date_process BETWEEN '".$startYears."' AND '".$endYears."' AND dept = '".$dept."'";
          // echo $stQuery;
          // exit();
          $query   = $this->db->query($stQuery);
          return $query->getRowArray();
     }

}